/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

buildscript {
    ext.kotlin_version = '1.2.21'

    repositories {
        mavenCentral()
    }

    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

plugins {
    id 'application'
}

apply plugin: "kotlin"

compileKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
    }
}

mainClassName = 'io.vertx.core.Launcher'

task webpack(type: Exec) {
    commandLine "$projectDir/node_modules/.bin/webpack"
}

build {
    dependsOn webpack
}

run {
    dependsOn webpack
}

repositories {
    mavenCentral()
    jcenter()
}

dependencies {
    compile "io.vertx:vertx-core:3.5.1"
    compile "io.vertx:vertx-web:3.5.1"
    compile "io.vertx:vertx-lang-js:3.5.1"
    compile "org.jetbrains.kotlin:kotlin-stdlib"
    compile "io.vertx:vertx-web:3.3.3:client@js"
    compile "io.vertx:vertx-web-templ-handlebars:3.5.1"
}

run {
    args = [
        "run",
        "counter.CounterEndpointVerticle",
//      Try one per core!
//      "-instances2",
        "--launcher-class=io.vertx.core.Launcher",
        "--on-redeploy=gradle classes"
    ]
}
